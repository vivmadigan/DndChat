@model JoinViewModel
@{
    ViewData["Title"] = "Chat";
}

<div class="container py-4 text-center"
     id="root"
     data-joined="@Model.Joined.ToString().ToLower()"
     data-username="@Model.Username">
    <h1 class="display-4">Welcome to DndChat!</h1>
    <p>Enter a username to start.</p>

    <!-- Join form (server validated) -->
    <div class="card mx-auto mb-3" style="max-width:720px;">
        <div class="card-body">
            <form asp-action="Index" method="post" class="row g-2 justify-content-center">
                @Html.AntiForgeryToken()
                <input asp-for="Username" class="form-control" />
                <button type="submit" class="btn btn-primary">Start</button>
            </form>
        </div>
    </div>

    <!-- Chat UI (shown after valid POST) -->
    <div id="chatCard" class="card mx-auto @(Model.Joined ? "" : "d-none")" style="max-width:720px;">
        <div class="card-header">Global chat</div>
        <ul id="messagesList" class="list-group list-group-flush" style="max-height:50vh; overflow:auto;"></ul>
        <div class="card-body">
            <div class="input-group">
                <input id="messageInput" class="form-control" placeholder="Type a message" autocomplete="off" @(Model.Joined ? "" : "disabled") />
                <button id="sendBtn" type="button" class="btn btn-success" @(Model.Joined ? "" : "disabled")>
                    Chat
                </button>
            </div>
        </div>
    </div>

    <div id="status" class="mt-3"></div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
    <script src="~/js/chat.js"></script>
}
